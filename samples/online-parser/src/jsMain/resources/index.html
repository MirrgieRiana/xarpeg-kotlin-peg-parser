<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Online Parser Sample</title>
    <style>
        :root {
            color-scheme: light;
            --surface: #ffffff;
            --ink: #1f2933;
            --muted: #52606d;
            --accent: #2563eb;
            --accent-strong: #1d4ed8;
            --accent-strong-hover: #143ec7;
            --accent-focus: #cbdafe;
            --border: #e5e7eb;
            --textarea-bg: #fbfdff;
            --button-text: #ffffff;
            --shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
            --code-bg: #f8fafc;
            --code-text: #1f2933;
            --code-border: #e5e7eb;
            --code-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }
        * { box-sizing: border-box; }
        body {
            font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
            background: radial-gradient(circle at 20% 20%, #f3f6ff, #f8fafc 45%, #eef2ff 100%);
            color: var(--ink);
            margin: 0;
            padding: 2.5rem 1.25rem 3rem;
            display: flex;
            justify-content: center;
        }
        main {
            width: min(960px, 100%);
            background: var(--surface);
            padding: 2rem 1.75rem;
            border-radius: 18px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        h1 {
            margin: 0 0 1rem;
            font-size: clamp(1.6rem, 3vw, 2rem);
            letter-spacing: 0.02em;
        }
        p.lead { margin: 0 0 1.5rem; color: var(--muted); }
        label { font-weight: 700; color: var(--ink); }
        textarea {
            width: 100%;
            min-height: 0;
            height: auto;
            padding: 0.85rem 1rem;
            margin-top: 0.4rem;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: var(--textarea-bg);
            color: var(--ink);
            font-size: 1rem;
            line-height: 1.4;
            resize: vertical;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);
        }
        textarea:focus {
            outline: 2px solid var(--accent-focus);
            border-color: var(--accent-focus);
        }
        .section {
            display: grid;
            gap: 0.4rem;
            margin-bottom: 1.5rem;
        }
        .muted-text { margin: 0; color: var(--muted); }
        .muted-list { margin: 0.2rem 0 0; padding-left: 1.1rem; color: var(--muted); }
        .muted-list li { margin: 0.2rem 0; }
        .link-row { display: flex; flex-wrap: wrap; gap: 0.6rem; justify-content: flex-end; }
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            justify-content: space-between;
        }
        button {
            appearance: none;
            border: 1px solid var(--accent-strong);
            background: linear-gradient(135deg, var(--accent), var(--accent-strong));
            color: var(--button-text);
            padding: 0.55rem 1.2rem;
            border-radius: 12px;
            font-weight: 700;
            letter-spacing: 0.01em;
            cursor: pointer;
            box-shadow: 0 8px 18px rgba(37, 99, 235, 0.25);
            transition: transform 120ms ease, box-shadow 120ms ease, filter 120ms ease;
        }
        button:hover { filter: brightness(1.03); box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3); }
        button:active { transform: translateY(1px); }
        .source {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            color: var(--accent-strong);
            font-weight: 700;
            text-decoration: none;
            border-bottom: 1px solid rgba(37, 99, 235, 0.25);
            padding-bottom: 0.08rem;
        }
        .source:hover { color: var(--accent-strong-hover); }
        .code-block {
            margin: 0.4rem 0 0;
            padding: 1rem;
            border-radius: 12px;
            background: var(--code-bg);
            color: var(--code-text);
            border: 1px solid var(--code-border);
            box-shadow: var(--code-shadow);
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            white-space: pre;
            overflow-x: auto;
        }
    </style>
</head>
    <body>
        <main>
            <h1>Online Parser Sample</h1>
            <p class="lead">This hosted sample from the <a class="source" href="https://github.com/MirrgieRiana/xarpeg-kotlin-peg-parser" target="_blank" rel="noopener noreferrer">Xarpeg Kotlin PEG Parser</a> documentation runs an arithmetic expression parser inspired by the “Expressions” guide in Kotlin/JS. It adds whitespace and decimal support so you can try the grammar without building the project.</p>

            <div class="section">
                <label for="input">Input</label>
                <textarea id="input" rows="3"></textarea>
            </div>

            <div class="section">
                <div class="section-header">
                    <label for="output">Output</label>
                    <button id="parse">Evaluate</button>
                </div>
                <textarea id="output" rows="3" readonly></textarea>
            </div>

            <div class="section">
                <div class="section-header">
                    <label>About this sample</label>
                    <div class="link-row">
                        <a class="source" href="https://mirrgieriana.github.io/xarpeg-kotlin-peg-parser/docs/index.html" target="_blank" rel="noopener noreferrer">Documentation home</a>
                    </div>
                </div>
                <p class="muted-text">The parser evaluates a simple arithmetic grammar with operator precedence, whitespace handling, and decimal numbers.</p>
                <ul class="muted-list">
                    <li>Enter expressions using <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, and parentheses.</li>
                    <li>See the evaluated result update as you type, or read the error message when parsing fails.</li>
                    <li>Use this page as a quick playground without running Gradle locally.</li>
                </ul>
            </div>

            <div class="section">
                <label>Grammar (PEG)</label>
                <p class="muted-text">This grammar follows the “Expressions” documentation chapter but includes whitespace and decimal support for interactive use.</p>
                <pre class="code-block"><code>Expression  &lt;- _ Product (_ ('+' / '-') _ Product)*
Product     &lt;- Factor (_ ('*' / '/') _ Factor)*
Factor      &lt;- Number / '(' _ Expression _ ')'
Number      &lt;- [0-9]+ ('.' [0-9]+)?
_           &lt;- [ \t\r\n]*</code></pre>
        </div>
    </main>

    <script type="module">
        import { parseExpression } from "./online-parser.mjs";

        const input = document.getElementById("input");
        const output = document.getElementById("output");
        const button = document.getElementById("parse");
        const defaultInput = "2*(3+4)+5";

        const updateOutput = () => {
            output.value = parseExpression(input.value);
        };

        const updateUrlQuery = () => {
            const url = new URL(window.location.href);
            url.searchParams.set("q", input.value);
            window.history.replaceState(null, "", url);
        };

        button.addEventListener("click", updateOutput);
        input.addEventListener("input", () => {
            updateUrlQuery();
            updateOutput();
        });

        // Set default input value only if input is empty on page load
        if (input.value.trim() === "") {
            const qParam = new URLSearchParams(window.location.search).get("q");
            if (qParam !== null) {
                input.value = qParam;
            } else {
                input.value = defaultInput;
            }
        }
        updateOutput();
    </script>
</body>
</html>
